<!DOCTYPE html>
<html>
<head>
  <title>Thermostat</title>
</head>
<body>
<h1>Living Room</h1>

<p>Temperature: <span id="temp">--</span> °C</p>
<p>Setpoint: <span id="setpoint">--</span> °C</p>
<p>Status: <span id="heating">--</span></p>

<form action="/setpoint" method="post">
  <input type="number" name="setpoint" step="0.5">
  <button type="submit">Set</button>
</form>

<br>
<a href="/settings">Settings</a>

<script>
async function refresh() {
  const res = await fetch("/api/state");
  const data = await res.json();

  if (data.temperature !== null) {
    document.getElementById("temp").innerText = data.temperature;
  }
  if (data.setpoint !== null) {
    document.getElementById("setpoint").innerText = data.setpoint;
  }
  document.getElementById("heating").innerText =
    data.heating ? "ON" : "OFF";
}

setInterval(refresh, 2000);
refresh();
</script>

</body>
</html>
